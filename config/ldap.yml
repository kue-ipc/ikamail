## LDAP
# You must change
# compitable Net::LDAP
ldap: &LDAP
  host: &HOST localhost
  port: &PORT <%= Rails.env == 'production' ? 389 : 389 %>
  # auth: :anonymous
  auth:
    method: :sipmle
    username: &AUTH_USRERNAME cn=admin,dc=example,dc=jp
    password: &AUTH_PASSOWRD <%= Rails.application.credentials.dig(:ldap, :password) || 'pass' %>
  base: &BASE dc=example,dc=jp
  encryption: null
  # encryption: :simple_tls
  # encryption: :start_tls
  # user
  user_dn: uid
  user_base: ou=Users
  user_class: posixAccount
  # group
  group_dn: cn
  group_base: ou=Groups
  group_class: posixGroup

## ActiveLdap
active_ldap: &ACTIVE_LDAP
  host: *HOST
  port: *PORT
  base: *BASE
  allow_anonymous: false
  bind_dn: *AUTH_USRERNAME
  password: *AUTH_PASSOWRD
  method: :plain
  # method: :ssl
  # method: :tls

## Devise LDAP Authorizatatble
# Uncomment out the merging for each environment that you'd like to include.
# You can also just copy and paste the tree (do not include the "authorizations") to each
# environment if you need something different per environment.
authorizations:
  required_groups:
    # If only a group name is given, membership will be checked against "uniqueMember"
    - cn=admin,ou=Groups,dc=example,dc=jp
    - cn=staff,ou=Groups,dc=example,dc=jp
    # If an array is given, the first element will be the attribute to check against, the second the group name
    # - ["moreMembers", "cn=users,ou=groups,dc=test,dc=com"]
  ## Requires config.ldap_check_attributes in devise.rb to be true
  ## Can have multiple attributes and values, must match all to be authorized
  # require_attribute:
    # objectClass: posixAccount
    # authorizationRole: postsAdmin
  ## Requires config.ldap_check_attributes_presence in devise.rb to be true
  ## Can have multiple attributes set to true or false to check presence, all must match all to be authorized
  require_attribute_presence:
    mail: true
    # telephoneNumber: true
    # serviceAccount: false

development:
  <<: *ACTIVE_LDAP

test:
  <<: *ACTIVE_LDAP

production:
  <<: *ACTIVE_LDAP
